# ThinOS
2021全国大学生计算机系统能力大赛 - 操作系统赛- 功能设计赛道 proj3

### 赛题描述
当前大学本科学生做操作系统课程实验面临的做内核难度高、工作量大；做一些应用的设计又导致难度太低，对操作系统理解不透彻等问题。为此，我们希望设计一组面向普通大学本科生的操作系统实验。 这个实验的目标是，将操作系统的知识点进行分解，先找到合适的（利用到操作系统知识点所支持的）应用，完成代理内核（即一个“刚刚好”的内核）的设计，并最终将应用在RISC-V的模拟环境（我们倾向于使用Spike）上运行起来。这一组操作系统实验的设计特点是：以典型应用驱动，带动内核的开发，随着应用的不断复杂化，最终获得一个功能较为完善的操作系统。
为此，我们采用了如下的规划思路：

* 在目标机方面，我们选择了支持RV64G指令集的RISC-V机器，为了方便部署和调试，我们推荐使用Spike模拟器，实验尽量利用Spike模拟器所提供的HTIF（Host-Target InterFace）来屏蔽底层硬件的具体操纵细节，将实验环节的设计重点放在操作系统的核心概念（如虚实转换、资源管理与调度）的实现上。考虑到PKE实验项目的重点是应用驱动内核开发，参赛作品对目标机的选择并不局限于Spike，也可以采用QEMU，只要遵从应用驱动内核开发的思想，实验设计能够体现操作系统的核心内容（而不是放在某某硬件的具体操纵上）即可。
* 在软件编程语言方面，我们推荐使用C语言和RISC-V汇编语言，保证PKE实验的一致性。
* 在设计内容上，我们鼓励在PKE现有实验基础上的增量内容。如现有实验的挑战（进阶）版本，文件系统实验、设备管理实验等。

PKE现有的文档和源码：

* （文档）：https://gitee.com/hustos/pke-doc
* （代码）：https://gitee.com/hustos/riscv-pke

### 项目介绍

本项目实现了中断相关的两个挑战实验、内存相关的两个挑战实验、进程相关的两个挑战实验和设备相关的三个基础实验，每个挑战实验都有难度说明和详细的指导文档，并且与所涉知识息息相关，其难度和基础实验也有足够的差距，能够更好地提升学生操作系统方面的视野和思考能力。项目完全使用C语言和RISC-V汇编语言，保证PKE实验的一致性，能够在Spike模拟器上实现预期功能。

在设备相关基础实验中，我们进一步实现了PKE内核在PYNQ Z2开发板上的运行，并通过实验引导学生改进PKE，使得PKE能够支持用户程序对PL端和PS端设备的控制，实现通过GPIO端口驱动小车，通过蓝牙端口接受控制和通过摄像头实现避障等功能，进一步强化了实验成果的实用性和知识学习的普适性。

### 文件说明
本文件夹下存放的是实验文档和实验答案源码，包含中断相关的两个挑战实验、内存相关的两个挑战实验、进程相关的两个挑战实验和设备相关的三个基础实验。其中：

* chapter3_traps.md、chapter4_memory.md和chapter5_process是6个挑战实验的**指导文档**，用于指导学生进行实验。
* answer-lab1_challenge1_backtrace.md等前缀为answer的markdown文件是6个挑战实验和设备相关的三个基础实验的**参考答案文档**，包含了实现实验要求的参考实现方式和思路，方便老师和学生学习实验相关知识。
* answer-lab1_challenge1_backtrace.zip等前缀为answer的zip压缩包是6个挑战实验和设备相关的三个基础实验的**参考答案源码**，包含了实现实验要求的参考实现源码，可和文档结合学习理解。

lab4_2控制小车展示视频：
https://pan.baidu.com/s/1SXL4USzVyMe-FTZ-zl-EZA
提取码：8gj4